package server

import (
	"crypto/tls"
	"crypto/x509"

	"github.com/elazarl/goproxy"
)

var caCert = []byte(`-----BEGIN CERTIFICATE-----
MIIGBTCCA+2gAwIBAgIUClho5mwY9gKWrD4iDF3C1LS+/DAwDQYJKoZIhvcNAQEL
BQAwgZExCzAJBgNVBAYTAkNOMQ8wDQYDVQQIDAZDZW50ZXIxDDAKBgNVBAcMA0xv
ZDESMBAGA1UECgwJTWlycm9yTWFuMRIwEAYDVQQLDAlNaXJyb3JNYW4xHDAaBgNV
BAMME21pcnJvcm1hbi5naXRodWIuaW8xHTAbBgkqhkiG9w0BCQEWDmllbG9uemhA
cXEuY29tMB4XDTIwMDcxMDA2MTAyNFoXDTQwMDcwNTA2MTAyNFowgZExCzAJBgNV
BAYTAkNOMQ8wDQYDVQQIDAZDZW50ZXIxDDAKBgNVBAcMA0xvZDESMBAGA1UECgwJ
TWlycm9yTWFuMRIwEAYDVQQLDAlNaXJyb3JNYW4xHDAaBgNVBAMME21pcnJvcm1h
bi5naXRodWIuaW8xHTAbBgkqhkiG9w0BCQEWDmllbG9uemhAcXEuY29tMIICIjAN
BgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAm25HLuSEITu4T2c9rABgWqDZI6l1
QjpbZ7VbjXDtspPzMu5RwH1QhackgGlqHQlaZnM/1c5J7uYSEi6CT1DoHVMMNUUc
ANwrR97VoWlXRkeFHbJT78nygCLkSsd2KXn1M9C5BXhxeQUfMxjjWsVOs983fd76
IUm4z+VNedW3sky03qjz37J+bjAtl6HUNeIDdOLj5XHi8qwcq4A35edgrd9NEP9z
VbL2nKL1B3Pbv3gG3/Tp4fHmPOBLTU377qRaMayuq0z4+QA1Vo6bdlNMGOWZOQSn
QGqtbjTxSjKlIkUxedK2lM77ZoD7urLd1/j4Fgo08zBcda1KgalSiMkW2cL9TKf3
h3WJd9OLMzRmLX2LXw68CaH8f9LuyemfXclDhEzddVb2wFufoZSyNP9VRsiyEpMn
ZY/nxp0GjPql9NWk34lBAg3UGpukQy05AUIhAupQH2wL+nfhz7Jr3+kkJ3KT59Uc
WlkFs86XCNb2ngAiBvPQl2R552MaI9DyiYBAjnBxVO6imeUYDP/h/RuA1xTa7SLm
4+0YcLk5keRsxi5Q5yKPPoo9QP+sb5zhdP9ZDHasfXobwnptGQViDf4BD/8LLPNx
wmUA+P2kaClwpoMcEFwscXuFblvyD9kqe+1ZyK1vPJedrtBdaRIBDjK4SN5ToAq0
IJJrYwrd+kw09P8CAwEAAaNTMFEwHQYDVR0OBBYEFLhMTxvLtQSPddtNdFkcHlQu
WEV4MB8GA1UdIwQYMBaAFLhMTxvLtQSPddtNdFkcHlQuWEV4MA8GA1UdEwEB/wQF
MAMBAf8wDQYJKoZIhvcNAQELBQADggIBACPp9l82VtDUMjT71wp67z9kaVvaUnoB
1+YI780QE5QUyXTtspBAeUS9epKatJBBhY+cmnohA1v3EbTjrpkQ6VPblxBB6TIb
L0IhbjQZLo5KV8TtFoom3x2QVm7hnKAEHv16Lg+FN3jNpO6rgqDS0qXN0ActVsRI
3zDyFNuztr31AleGoKezCowEhdLcl7y/uHuoRBUDPM7BwHfCfkxrP2ty0jOjTJAm
RQbmvzOhvcywFC0jMGzDMO1fHJ+P9nOkbqToH7yFCpO1nO/2tuFCFZkLM0jlQ9zf
IK1tt/ktzx+AspHn4vDu3zxE7C7E+X+FMAwgaBjXaaqZ1qhO0ICiKKGHq0neV6WB
rYfL4H6SA8BtQ77D2Y9kCulwE7cWLFqDUcnRr1Ql0keI/Fo8K0YnYNLOmkkg2Zas
A/qYw0iRxRGsLQB5XS+a/cUjN0VfhxZ8dWchwGUvkVmEr62oCDNqENtDK2QQ+4MQ
he0GJ6W48xloGrh/bgk/jZaerMvqUJDTyahAEE/wLXajzjxBD49uBsxsOMVm3//B
YhHTIL8WyGBzOQZMc+dnTOP763+LjrmQMOEsngr7tFx+b7kkF/hdX7jOeZnP3ZX7
VQNp+Yy1egtRq7tsQuBTitzzmiRO5oLj9gyg2K72W68eRYl1koDG0CU2oI53SgaE
vqU/6b6LQjjy
-----END CERTIFICATE-----`)

var caKey = []byte(`-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`)

var MirrormanCa, caErr = tls.X509KeyPair(caCert, caKey)

func init() {
	if caErr != nil {
		panic("Error parsing builtin CA " + caErr.Error())
	}
	var err error
	if MirrormanCa.Leaf, err = x509.ParseCertificate(MirrormanCa.Certificate[0]); err != nil {
		panic("Error parsing builtin CA " + err.Error())
	}
	goproxy.GoproxyCa = MirrormanCa
}
